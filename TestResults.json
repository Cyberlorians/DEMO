[
    {
        "ActualValue":  "",
        "Commandlet":  [
                           "Get-MgSubscribedSku",
                           "Get-PrivilegedUser"
                       ],
        "Control":  "AAD 2.12",
        "Criticality":  "Shall",
        "ReportDetails":  "0 admin(s) that are not cloud-only found",
        "Requirement":  "Users that need to be assigned to highly privileged Azure AD roles SHALL be provisioned cloud-only accounts that are separate from the on-premises directory or other federated identity providers",
        "RequirementMet":  true
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [

                       ],
        "Control":  "AAD 2.18",
        "Criticality":  "Should/Not-Implemented",
        "ReportDetails":  "Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.18 for instructions on manual check",
        "Requirement":  "Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [

                       ],
        "Control":  "AAD 2.2",
        "Criticality":  "Should/Not-Implemented",
        "ReportDetails":  "Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.2 for instructions on manual check",
        "Requirement":  "A notification SHOULD be sent to the administrator when high-risk users are detected",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [

                       ],
        "Control":  "AAD 2.4",
        "Criticality":  "Shall/Not-Implemented",
        "ReportDetails":  "Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.4 for instructions on manual check",
        "Requirement":  "If phishing-resistant MFA cannot be used, an MFA method from the list [see AAD baseline 2.4] SHALL be used in the interim",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [

                       ],
        "Control":  "AAD 2.4",
        "Criticality":  "Shall/Not-Implemented",
        "ReportDetails":  "Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.4 for instructions on manual check",
        "Requirement":  "Phishing-resistant MFA SHALL be used for all users",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [

                       ],
        "Control":  "AAD 2.4",
        "Criticality":  "Shall/Not-Implemented",
        "ReportDetails":  "Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.4 for instructions on manual check",
        "Requirement":  "SMS or Voice as the MFA method SHALL NOT be used",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [

                       ],
        "Control":  "AAD 2.5",
        "Criticality":  "Shall/Not-Implemented",
        "ReportDetails":  "Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.5 for instructions on manual check",
        "Requirement":  "The following critical logs SHALL be sent at a minimum: AuditLogs, SignInLogs, RiskyUsers, UserRiskEvents, NonInteractiveUserSignInLogs, ServicePrincipalSignInLogs, ADFSSignInLogs, RiskyServicePrincipals, ServicePrincipalRiskEvents",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [

                       ],
        "Control":  "AAD 2.5",
        "Criticality":  "Shall/Not-Implemented",
        "ReportDetails":  "Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.5 for instructions on manual check",
        "Requirement":  "The logs SHALL be sent to the agency\u0027s SOC for monitoring",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [

                       ],
        "Control":  "AAD 2.8",
        "Criticality":  "Shall/Not-Implemented",
        "ReportDetails":  "Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.8 for instructions on manual check",
        "Requirement":  "User passwords SHALL NOT expire",
        "RequirementMet":  false
    },
    {
        "ActualValue":  {
                            "all_allow_invite_values":  [
                                                            {
                                                                "AllowInvitesFromValue":  "adminsAndGuestInviters",
                                                                "PolicyId":  "authorizationPolicy"
                                                            }
                                                        ]
                        },
        "Commandlet":  [
                           "Get-MgPolicyAuthorizationPolicy"
                       ],
        "Control":  "AAD 2.18",
        "Criticality":  "Should",
        "ReportDetails":  "Permission level set to \"adminsAndGuestInviters\" (authorizationPolicy)",
        "Requirement":  "Only users with the Guest Inviter role SHOULD be able to invite guest users",
        "RequirementMet":  true
    },
    {
        "ActualValue":  {
                            "all_allowed_create_values":  [
                                                              {
                                                                  "DefaultUser_AllowedToCreateApps":  false,
                                                                  "PolicyId":  "authorizationPolicy"
                                                              }
                                                          ]
                        },
        "Commandlet":  [
                           "Get-MgPolicyAuthorizationPolicy"
                       ],
        "Control":  "AAD 2.6",
        "Criticality":  "Shall",
        "ReportDetails":  "0 authorization policies found that allow non-admin users to register third-party applications",
        "Requirement":  "Only administrators SHALL be allowed to register third-party applications",
        "RequirementMet":  true
    },
    {
        "ActualValue":  {
                            "all_consent_policies":  [
                                                         {
                                                             "IsEnabled":  false,
                                                             "PolicyId":  null
                                                         }
                                                     ]
                        },
        "Commandlet":  [
                           "Get-MgPolicyAdminConsentRequestPolicy"
                       ],
        "Control":  "AAD 2.7",
        "Criticality":  "Shall",
        "ReportDetails":  "Requirement not met",
        "Requirement":  "An admin consent workflow SHALL be configured",
        "RequirementMet":  false
    },
    {
        "ActualValue":  {
                            "all_grant_policy_values":  [
                                                            {
                                                                "DefaultUser_DefaultGrantPolicy":  [

                                                                                                   ],
                                                                "PolicyId":  "authorizationPolicy"
                                                            }
                                                        ]
                        },
        "Commandlet":  [
                           "Get-MgPolicyAuthorizationPolicy"
                       ],
        "Control":  "AAD 2.7",
        "Criticality":  "Shall",
        "ReportDetails":  "0 authorization policies found that allow non-admin users to consent to third-party applications",
        "Requirement":  "Only administrators SHALL be allowed to consent to third-party applications",
        "RequirementMet":  true
    },
    {
        "ActualValue":  {
                            "all_roleid_values":  [
                                                      {
                                                          "GuestUserRoleId":  "10dae51f-b6af-4016-8d66-8c2a99b929b3",
                                                          "GuestUserRoleIdString":  "Limited access",
                                                          "Id":  "authorizationPolicy"
                                                      }
                                                  ]
                        },
        "Commandlet":  [
                           "Get-MgPolicyAuthorizationPolicy"
                       ],
        "Control":  "AAD 2.18",
        "Criticality":  "Should",
        "ReportDetails":  "Permission level set to \"Limited access\" (authorizationPolicy)",
        "Requirement":  "Guest users SHOULD have limited access to Azure AD directory objects",
        "RequirementMet":  true
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [
                           "Get-MgIdentityConditionalAccessPolicy"
                       ],
        "Control":  "AAD 2.1",
        "Criticality":  "Shall",
        "ReportDetails":  "0 conditional access policy(s) found that meet(s) all requirements. \u003ca href=\u0027#caps\u0027\u003eView all CA policies\u003c/a\u003e.",
        "Requirement":  "Legacy authentication SHALL be blocked",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [
                           "Get-MgIdentityConditionalAccessPolicy"
                       ],
        "Control":  "AAD 2.10",
        "Criticality":  "Shall",
        "ReportDetails":  "0 conditional access policy(s) found that meet(s) all requirements. \u003ca href=\u0027#caps\u0027\u003eView all CA policies\u003c/a\u003e.",
        "Requirement":  "Browser sessions SHALL not be persistent",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [
                           "Get-MgIdentityConditionalAccessPolicy"
                       ],
        "Control":  "AAD 2.17",
        "Criticality":  "Should",
        "ReportDetails":  "0 conditional access policy(s) found that meet(s) all requirements. \u003ca href=\u0027#caps\u0027\u003eView all CA policies\u003c/a\u003e.",
        "Requirement":  "Managed devices SHOULD be required for authentication",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [
                           "Get-MgIdentityConditionalAccessPolicy"
                       ],
        "Control":  "AAD 2.2",
        "Criticality":  "Shall",
        "ReportDetails":  "0 conditional access policy(s) found that meet(s) all requirements. \u003ca href=\u0027#caps\u0027\u003eView all CA policies\u003c/a\u003e.",
        "Requirement":  "Users detected as high risk SHALL be blocked",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [
                           "Get-MgIdentityConditionalAccessPolicy"
                       ],
        "Control":  "AAD 2.3",
        "Criticality":  "Shall",
        "ReportDetails":  "0 conditional access policy(s) found that meet(s) all requirements. \u003ca href=\u0027#caps\u0027\u003eView all CA policies\u003c/a\u003e.",
        "Requirement":  "Sign-ins detected as high risk SHALL be blocked",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [
                           "Get-MgIdentityConditionalAccessPolicy"
                       ],
        "Control":  "AAD 2.4",
        "Criticality":  "Shall",
        "ReportDetails":  "0 conditional access policy(s) found that meet(s) all requirements. \u003ca href=\u0027#caps\u0027\u003eView all CA policies\u003c/a\u003e.",
        "Requirement":  "MFA SHALL be required for all users",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [
                           "Get-MgIdentityConditionalAccessPolicy"
                       ],
        "Control":  "AAD 2.9",
        "Criticality":  "Shall",
        "ReportDetails":  "0 conditional access policy(s) found that meet(s) all requirements. \u003ca href=\u0027#caps\u0027\u003eView all CA policies\u003c/a\u003e.",
        "Requirement":  "Sign-in frequency SHALL be configured to 12 hours",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [

                        ],
        "Commandlet":  [
                           "Get-MgSubscribedSku",
                           "Get-PrivilegedRole",
                           "Get-MgIdentityConditionalAccessPolicy"
                       ],
        "Control":  "AAD 2.13",
        "Criticality":  "Shall",
        "ReportDetails":  "0 conditional access policy(s) found that meet(s) all requirements. \u003ca href=\u0027#caps\u0027\u003eView all CA policies\u003c/a\u003e.",
        "Requirement":  "MFA SHALL be required for user access to highly privileged roles",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [
                            "Application Administrator",
                            "Cloud Application Administrator",
                            "Exchange Administrator",
                            "Global Administrator",
                            "Hybrid Identity Administrator",
                            "Privileged Role Administrator",
                            "SharePoint Administrator",
                            "User Administrator"
                        ],
        "Commandlet":  [
                           "Get-MgSubscribedSku",
                           "Get-PrivilegedRole"
                       ],
        "Control":  "AAD 2.14",
        "Criticality":  "Shall",
        "ReportDetails":  "8 role(s) configured to allow permanent active assignment or expiration period too long:\u003cbr/\u003eApplication Administrator, Cloud Application Administrator, Exchange Administrator, Global Administrator, Hybrid Identity Administrator, Privileged Role Administrator, SharePoint Administrator, User Administrator",
        "Requirement":  "Permanent active role assignments SHALL NOT be allowed for highly privileged roles. Active assignments SHALL have an expiration period.",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [
                            "Application Administrator",
                            "Cloud Application Administrator",
                            "Exchange Administrator",
                            "Global Administrator",
                            "Hybrid Identity Administrator",
                            "Privileged Role Administrator",
                            "SharePoint Administrator",
                            "User Administrator"
                        ],
        "Commandlet":  [
                           "Get-MgSubscribedSku",
                           "Get-PrivilegedRole"
                       ],
        "Control":  "AAD 2.15",
        "Criticality":  "Should",
        "ReportDetails":  "8 role(s) that do not require approval to activate found:\u003cbr/\u003eApplication Administrator, Cloud Application Administrator, Exchange Administrator, Global Administrator, Hybrid Identity Administrator, Privileged Role Administrator, SharePoint Administrator, User Administrator",
        "Requirement":  "Activation of highly privileged roles SHOULD require approval",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [
                            "Application Administrator",
                            "Cloud Application Administrator",
                            "Exchange Administrator",
                            "Global Administrator",
                            "Hybrid Identity Administrator",
                            "Privileged Role Administrator",
                            "SharePoint Administrator",
                            "User Administrator"
                        ],
        "Commandlet":  [
                           "Get-MgSubscribedSku",
                           "Get-PrivilegedRole"
                       ],
        "Control":  "AAD 2.16",
        "Criticality":  "Shall",
        "ReportDetails":  "8 role(s) without notification e-mail configured for role assignments found:\u003cbr/\u003eApplication Administrator, Cloud Application Administrator, Exchange Administrator, Global Administrator, Hybrid Identity Administrator, Privileged Role Administrator, SharePoint Administrator, User Administrator",
        "Requirement":  "Eligible and Active highly privileged role assignments SHALL trigger an alert",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [
                            "Application Administrator",
                            "Cloud Application Administrator",
                            "Exchange Administrator",
                            "Global Administrator",
                            "Hybrid Identity Administrator",
                            "Privileged Role Administrator",
                            "SharePoint Administrator",
                            "User Administrator"
                        ],
        "Commandlet":  [
                           "Get-MgSubscribedSku",
                           "Get-PrivilegedRole"
                       ],
        "Control":  "AAD 2.16",
        "Criticality":  "Shall",
        "ReportDetails":  "Requirement not met",
        "Requirement":  "User activation of the Global Administrator role SHALL trigger an alert",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [
                            "Application Administrator",
                            "Cloud Application Administrator",
                            "Exchange Administrator",
                            "Hybrid Identity Administrator",
                            "Privileged Role Administrator",
                            "SharePoint Administrator",
                            "User Administrator"
                        ],
        "Commandlet":  [
                           "Get-MgSubscribedSku",
                           "Get-PrivilegedRole"
                       ],
        "Control":  "AAD 2.16",
        "Criticality":  "Should",
        "ReportDetails":  "7 role(s) without notification e-mail configured for role activations found:\u003cbr/\u003eApplication Administrator, Cloud Application Administrator, Exchange Administrator, Hybrid Identity Administrator, Privileged Role Administrator, SharePoint Administrator, User Administrator",
        "Requirement":  "User activation of other highly privileged roles SHOULD trigger an alert",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [
                            "Global Administrator"
                        ],
        "Commandlet":  [
                           "Get-MgSubscribedSku",
                           "Get-PrivilegedRole"
                       ],
        "Control":  "AAD 2.14",
        "Criticality":  "Shall",
        "ReportDetails":  "1 role(s) assigned to users outside of PIM:\u003cbr/\u003eGlobal Administrator",
        "Requirement":  "Provisioning of users to highly privileged roles SHALL NOT occur outside of a PAM system, such as the Azure AD PIM service, because this bypasses the controls the PAM system provides",
        "RequirementMet":  false
    },
    {
        "ActualValue":  [
                            "Matthew Zorich",
                            "Michael Crane",
                            "break glass",
                            "wvcrane bg"
                        ],
        "Commandlet":  [
                           "Get-MgSubscribedSku",
                           "Get-PrivilegedUser"
                       ],
        "Control":  "AAD 2.11",
        "Criticality":  "Shall",
        "ReportDetails":  "4 global admin(s) found:\u003cbr/\u003eMatthew Zorich, Michael Crane, break glass, wvcrane bg",
        "Requirement":  "A minimum of two users and a maximum of four users SHALL be provisioned with the Global Administrator role",
        "RequirementMet":  true
    },
    {
        "ActualValue":  [
                            {
                                "Name":  "EnableGroupSpecificConsent",
                                "SettingsGroup":  "Consent Policy Settings",
                                "Value":  "false"
                            }
                        ],
        "Commandlet":  [
                           "Get-MgDirectorySetting"
                       ],
        "Control":  "AAD 2.7",
        "Criticality":  "Shall",
        "ReportDetails":  "Requirement met",
        "Requirement":  "Group owners SHALL NOT be allowed to consent to third-party applications",
        "RequirementMet":  true
    }
]
